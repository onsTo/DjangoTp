{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="header">
        <h1>Liste des conf√©rences</h1>
        <p class="subtitle">D√©couvrez toutes les conf√©rences disponibles</p>
        <div class="conference-count">{{ liste|length }} conf√©rence{{ liste|length|pluralize }}</div>
    </div>
    
{% if user.is_authenticated and user.role == "commitee" %}
    <div style="margin-bottom: 20px;">
        <a href="{% url 'Conference_add' %}" class="btn-elegant">
            <div class="btn-icon">+</div>
            <span>Ajouter conf√©rence</span>
        </a>
    </div>
    {% endif %}

    <div class="filters">
        <div class="filter-group">
            <label class="filter-label" for="theme-filter">Filtrer par th√®me</label>
            <select class="filter-select" id="theme-filter">
                <option value="">Tous les th√®mes</option>
                {% for code, label in themes %}
                    <option value="{{ code }}">{{ label }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="filter-group">
            <label class="filter-label" for="location-filter">Filtrer par lieu</label>
            <input type="text" class="filter-input" id="location-filter" placeholder="Entrez un lieu...">
        </div>
    </div>

    <div class="conferences-grid">
        {% if liste %}
            {% for conference in liste %}
            <div class="conference-card">
                <h3 class="conference-title">{{ conference.name }}</h3>
                <div class="conference-location">{{ conference.location }}</div>
                <div class="conference-theme">{{ conference.get_theme_display }}</div>
                <div class="conference-dates">
                    <div class="date-item">
                        <div class="date-label">D√©but</div>
                        <div class="date-value">{{ conference.start_date }}</div>
                    </div>
                    <div class="date-item">
                        <div class="date-label">Fin</div>
                        <div class="date-value">{{ conference.end_date }}</div>
                    </div>
                </div>
                <div class="card-actions" style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px;">
                    <div style="display: flex; gap: 10px;">
                        <a href="{% url 'Conference_detail' pk=conference.pk %}" class="btn btn-view btn-bleu">Voir d√©tails</a>

                        <!-- Afficher les boutons Modifier et Supprimer uniquement pour les utilisateurs connect√©s avec le r√¥le "commitee" -->
                        {% if user.is_authenticated and user.role == "commitee" %}
                        <a href="{% url 'Conference_edit' pk=conference.pk %}" class="btn btn-edit btn-vert">Modifier</a>
                        <a href="{% url 'Conference_delete' pk=conference.pk %}" class="btn btn-delete">Supprimer</a>
                        {% endif %}


                    </div>
                    <div class="conference-meta" style="font-size: 0.9em; color: #666;">
                        Cr√©√©e le {{ conference.created_at|date:"d/m/Y" }}
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">üìÖ</div>
                <h3 class="empty-title">Aucune conf√©rence disponible</h3>
                <p class="empty-text">Il n'y a actuellement aucune conf√©rence √† afficher. Revenez plus tard pour d√©couvrir de nouveaux √©v√©nements.</p>
            </div>
        {% endif %}
    </div>
</div>

<script>
    // Script simple pour la recherche/filtrage
    document.addEventListener('DOMContentLoaded', function() {
        const themeFilter = document.getElementById('theme-filter');
        const locationFilter = document.getElementById('location-filter');
        const conferenceCards = document.querySelectorAll('.conference-card');

        function filterConferences() {
            const themeValue = themeFilter.value.toLowerCase();
            const locationValue = locationFilter.value.toLowerCase();

            conferenceCards.forEach(card => {
                const theme = card.querySelector('.conference-theme').textContent.toLowerCase();
                const location = card.querySelector('.conference-location').textContent.toLowerCase();

                const themeMatch = !themeValue || theme.includes(themeValue);
                const locationMatch = !locationValue || location.includes(locationValue);

                card.style.display = (themeMatch && locationMatch) ? 'block' : 'none';
            });
        }

        themeFilter.addEventListener('change', filterConferences);
        locationFilter.addEventListener('input', filterConferences);
    });
</script>
{% endblock %}
